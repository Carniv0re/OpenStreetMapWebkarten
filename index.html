<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de-de">
<head>
	<title>Map | Testanwendung</title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<meta http-equiv="content-script-type" content="text/javascript" />
	<meta http-equiv="content-style-type" content="text/css" />
	<meta http-equiv="content-language" content="en" />
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />
	<link rel="stylesheet" type="text/css" href="Leaflet.markercluster-1.0.4/dist/MarkerCluster.css"></link>
	<link rel="stylesheet" type="text/css" href="Leaflet.markercluster-1.0.4/dist/MarkerCluster.Default.css"></link>
	<link rel="stylesheet" type="text/css" href="map.css"></link>
	<link href='https://api.mapbox.com/mapbox-gl-js/v0.34.0/mapbox-gl.css' rel='stylesheet' />
	<!--[if IE]>
	<link rel="stylesheet" type="text/css" href="ie_map.css"></link>
	<![endif]-->
	<script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
	<script src='https://api.mapbox.com/mapbox-gl-js/v0.34.0/mapbox-gl.js'></script>
	<script src='https://api.mapbox.com/mapbox.js/v3.0.1/mapbox.js'></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script type="text/javascript" src="Leaflet.markercluster-1.0.4/dist/leaflet.markercluster.js"></script>
	
	<script type="text/javascript" src="JS/geojsonHandler.js"></script>
</head>
<body>
<div id="mapid"></div>

<div id="latlng"></div>

<img src="HTML-image/gebaeude6.png" alt="hsr" usemap="#hsrmap">

<map name="hsrmap">
	<area shape="rect" coords="0,0,82,126" href="HTML-image/gebaeude6.html" alt="Gebaeude 6">
</map>

<script type="text/javascript">
	L.mapbox.accessToken = 'pk.eyJ1Ijoic2ZyaXRzY2hpIiwiYSI6ImNqMWM3bWc0ZzAwNHczM3BhdDY3aGM4NHUifQ.4L6rSyUbvozhhYjbhl8HRg';
	
	var osmAttributionUrl = "http://www.openstreetmap.org/copyright";
	var osmAttributionText = "OSM";
	var mapboxAttributionUrl = "https://www.mapbox.com/about/maps/";
	var mapboxAttributionText = "MapBox";
	
	var mapboxUrl = "http://api.tiles.mapbox.com/v4/sfkeller.k0onh2me/{z}/{x}/{y}.png?access_token=pk.eyJ1Ijoic2ZrZWxsZXIiLCJhIjoia3h4T3pScyJ9.MDLSUwpRpPqaV7SVfGcZDw";
	var osmUrl = "http://tile.osm.ch/osm-swiss-style/{z}/{x}/{y}.png";
	
	var createAttribution = function(mapsrc, mapdesc){
		return "<a href='http://wiki.openstreetmap.org/wiki/Open_Database_License'>OpenStreetMap</a> contributors | "
			+ "Map data &copy; <a href=" + mapsrc + ">" + mapdesc + "</a> | "
			+ "<a href='http://giswiki.hsr.ch/Webmapping_Clients'>About</a> | "
			+ "<a href='http://www.hsr.ch/geometalab'>By GeometaLab</a>";
	};

	var osmAttribution = createAttribution(osmAttributionUrl, osmAttributionText);
	var mapboxAttribution = createAttribution(mapboxAttributionUrl, mapboxAttributionText);
	
	var mapboxStreets = L.tileLayer(osmUrl, {id: 'mapid', attribution: mapboxAttribution}),
		mapboxSatellite = L.tileLayer(mapboxUrl, {id: 'mapid', attribution: mapboxAttribution});
		
	var baseMaps = {
		"Streets": mapboxStreets,
		"Satellite": mapboxSatellite
	};
	
	var map = L.map('mapid', {
		center: [47.22320, 8.81744],
		zoom: 17,
		layers: [mapboxStreets, mapboxSatellite]
	});
	
	var marker = L.marker([47.22234, 8.81727]);
	var polygon = L.polygon([
		[47.22354, 8.81872],
		[47.22325, 8.8182],
		[47.22294, 8.81857],
		[47.22323, 8.81909]
	], {
		color: '#dde21a',
		fillColor: 'yellow',
		fillOpacity: 0.5
	});
	var circle = L.circle([47.2225, 8.81481], {
		color: 'red',
		fillColor: '#f03',
		fillOpacity: 0.5,
		radius: 20
	});
	var popup = L.popup();
	
	var markers = new L.markerClusterGroup();
	
	for(var i = 1; i <= 10; i++) {
		var lng = 47.22573 + i / 1000;
		for(var j = 1; j <= 10; j++) {
			var lat = 8.81815 + j / 1000;
			var clusterMarker = L.marker([lng, lat]);
			
			markers.addLayer(clusterMarker);
		}
	}
	
	map.addLayer(markers);
	
	var trainStationPath = "GeoJSON/trainStation.geojson";
	var building6Path = "GeoJSON/building6.geojson";
	
	var geoJTrain = getGeojson(trainStationPath);
	var geoJB6 = getGeojson(building6Path);
	
	function postLatlngOnMousemove(e) {
		$('#latlng').html(e.latlng.toString());
	}
	
	marker.bindPopup("<b>F채schtinseli</b>");
	polygon.bindPopup("<b>Geb채ude 8</b>");
	circle.bindPopup("<b>Heilig H체sli</b><br>...");
	geoJTrain.bindPopup("<b>Bahnhof Rapperswil</b>");
	geoJB6.bindPopup("<b>Geb채ude 6</b>");
	
	var mapElements = L.layerGroup([marker, polygon, circle, geoJTrain, geoJB6]);
	
	var overlayMaps = {
		"Map elements": mapElements
	};
	
	L.control.layers(baseMaps, overlayMaps).addTo(map);
	
	map.on('mousemove', postLatlngOnMousemove);
</script>
</body>
</html>